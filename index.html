<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Document</title>
</head>
<body>
    <canvas id="canvas"></canvas>

    <script id="vs" type="x-shader/x-vertex">
        attribute vec3 position;
        attribute vec4 color;
        attribute vec2 textureCoord;
        uniform mat4 mvpMatrix;
        uniform float vertexAlpha;
        varying vec4 vColor;
        varying vec2 vTextureCoord;

        void main() {
            vColor = vec4(color.rgb, color.a * vertexAlpha);
            vTextureCoord = textureCoord;
            gl_Position = mvpMatrix * vec4(position, 1.0);
        }
    </script>

    <script id="fs" type="x-shader/x-fragment">
        precision mediump float;

        uniform sampler2D texture;
        uniform int isUseTexture;
        varying vec4 vColor;
        varying vec2 vTextureCoord;

        float random(vec3 scale, float seed) {
            return fract(sin(dot(gl_FragCoord.xyz + seed, scale)) * 43758.5453 + seed);
        }

        void main() {
            // float r = 0.005 * random(vec3(1.0, 1.2, 1.5), 0.0);
            // vec2 tPos = vec2(1.2, 1.0 - 1.3 + r);

            if(bool(isUseTexture)) {
                vec4 smpColor = texture2D(texture, vTextureCoord);
                gl_FragColor = vColor * smpColor;

            } else {
                gl_FragColor = vColor;

            }
        }
    </script>










    <script id="vs2" type="x-shader/x-vertex">
        attribute vec3 position;
        attribute vec4 color;
        uniform vec3 mvpMatrix;
        varying vec4 vColor;

        void main() {
            vColor = color;
            gl_Position = mvpMatrix * vec4(position, 1.0);
        }
    </script>


    <script id="fs2" type="x-shader/x-fragment">
        precision mediump float;

        uniform sampler2D texture;
        uniform bool useBlur;
        varying vec4 vColor;

        void main() {
            vec2 tFrag = vec2(1.0 / 256.0);
            vec4 destColor = texture2D(texture, gl_FragCoord.st * tFrag);
            if(useBlur) {
                destColor *= 0.36;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2(-1.0,  1.0)) * tFrag) * 0.04;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2( 0.0,  1.0)) * tFrag) * 0.04;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2( 1.0,  1.0)) * tFrag) * 0.04;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2(-1.0,  0.0)) * tFrag) * 0.04;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2( 1.0,  0.0)) * tFrag) * 0.04;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2(-1.0, -1.0)) * tFrag) * 0.04;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2( 0.0, -1.0)) * tFrag) * 0.04;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2( 1.0, -1.0)) * tFrag) * 0.04;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2(-2.0,  2.0)) * tFrag) * 0.02;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2(-1.0,  2.0)) * tFrag) * 0.02;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2( 0.0,  2.0)) * tFrag) * 0.02;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2( 1.0,  2.0)) * tFrag) * 0.02;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2( 2.0,  2.0)) * tFrag) * 0.02;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2(-2.0,  1.0)) * tFrag) * 0.02;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2( 2.0,  1.0)) * tFrag) * 0.02;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2(-2.0,  0.0)) * tFrag) * 0.02;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2( 2.0,  0.0)) * tFrag) * 0.02;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2(-2.0, -1.0)) * tFrag) * 0.02;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2( 2.0, -1.0)) * tFrag) * 0.02;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2(-2.0, -2.0)) * tFrag) * 0.02;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2(-1.0, -2.0)) * tFrag) * 0.02;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2( 0.0, -2.0)) * tFrag) * 0.02;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2( 1.0, -2.0)) * tFrag) * 0.02;
                destColor += texture2D(texture, (gl_FragCoord.st + vec2( 2.0, -2.0)) * tFrag) * 0.02;
            }
            gl_FragColor = vColor * destColor;
        }
    </script>

    <script src="gl-matrix-min.js"></script>
    <script src="lodash.js"></script>
    <script src="main.js"></script>
</body>
</html>